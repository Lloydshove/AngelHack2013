package photoapp;import java.io.IOException;import java.util.Random;import javax.servlet.ServletException;import javax.servlet.http.*;import org.eclipse.jetty.server.Request;import org.eclipse.jetty.server.handler.AbstractHandler;import org.eclipse.jetty.servlet.*;import static java.lang.Double.parseDouble;public class Server extends HttpServlet {    @Override    protected void doGet(HttpServletRequest req, HttpServletResponse resp)            throws ServletException, IOException {        resp.getWriter().print(CONTENT);    }    public static void main(String[] args) throws Exception{        org.eclipse.jetty.server.Server server = new org.eclipse.jetty.server.Server(1080);        RequestHandler context = new RequestHandler();        server.setHandler(context);        server.start();        server.join();       }    public static String CONTENT =            "[{" +                    "\"lat\":1.2589483280609064," +                    "\"lng\":103.86431503295901," +                    "\"imgs\": [ " +                    "\"http://farm1.staticflickr.com/2/1418878_1e92283336_m.jpg\", " +                    "\"http://farm1.staticflickr.com/2/1418878_1e92283336_m.jpg\"" +                    "]" +                    "}," +                    "{" +                    "\"lat\":1.2650483280609064," +                    "\"lng\":103.86431503295901," +                    "\"imgs\": [ " +                    "\"http://farm1.staticflickr.com/2/1418878_1e92283336_m.jpg\", " +                    "\"http://farm1.staticflickr.com/2/1418878_1e92283336_m.jpg\"" +                    "]" +                    "}]";    public static class RequestHandler extends AbstractHandler    {        @Override        public void handle(String s, Request baseRequest, HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {            response.setContentType("text/html;charset=utf-8");            response.setStatus(HttpServletResponse.SC_OK);            response.addHeader("Access-Control-Allow-Origin", "*");            response.addHeader("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");            baseRequest.setHandled(true);            Double swLat = parseDouble(request.getParameter("southWestLat"));            Double swLon = parseDouble(request.getParameter("southWestLng"));            Double neLat = parseDouble(request.getParameter("northEastLat"));            Double neLon = parseDouble(request.getParameter("northEastLng"));            response.getWriter().println(                    "[" +                            randomPoint(swLat, swLon, neLat, neLon) + "," +                            randomPoint(swLat, swLon, neLat, neLon) + "," +                            randomPoint(swLat, swLon, neLat, neLon) + "," +                            randomPoint(swLat, swLon, neLat, neLon) + "," +                            randomPoint(swLat, swLon, neLat, neLon) + "]"            );        }        private String randomPoint(Double swLat, Double swLon, Double neLat, Double neLon) {            Random rand = new Random();            Double newLat = swLat + (rand.nextDouble() * (neLat-swLat));            Double newLon = swLon + (rand.nextDouble() * (neLon-swLon));            return "{" +                    "\"lat\":" + newLat + "," +                            "\"lng\":"+ newLon +"," +                            "\"imgs\": [ " +                            toUrl("3", "2857", "9034939815", "46015f831b")+ "," +                            toUrl("6", "5511", "9037160796", "fd7c3de6a2")+ "," +                            toUrl("4", "3786", "9034940627", "74a1a7bcca")+ "," +                            toUrl("6", "5349", "9037161474", "6e8b88d165")+                            "]" +                            "}";        }    }    public static String toUrl(String farmId, String serverId, String id, String secret){        return "\"http://farm"+farmId+".staticflickr.com/"+ serverId + "/" + id + "_" + secret + ".jpg\"";    }}